<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>CommercetoolsAuth | @gradientedge/commercetools-utils</title><meta name="description" content="Documentation for @gradientedge/commercetools-utils"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@gradientedge/commercetools-utils</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">@gradientedge/commercetools-utils</a></li><li><a href="CommercetoolsAuth.html">CommercetoolsAuth</a></li></ul><h1>Class CommercetoolsAuth</h1></div><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><p>Provides an easy to use set of methods for communicating with the commercetools
HTTP Authorization API: <a href="https://docs.commercetools.com/api/authorization">https://docs.commercetools.com/api/authorization</a></p>
<p>To create an instance of the class and get a client grant:</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">Region</span><span class="hl-1">, </span><span class="hl-5">CommercetoolsAuth</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@gradientedge/commercetools-utils&#39;</span><br/><br/><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">example</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">auth</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CommercetoolsAuth</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">projectKey:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-project-key&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientId:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientSecret:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-secret&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">region:</span><span class="hl-1"> </span><span class="hl-5">Region</span><span class="hl-1">.</span><span class="hl-6">EUROPE_GCP</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientScopes:</span><span class="hl-1"> [</span><span class="hl-2">&#39;create_anonymous_token&#39;</span><span class="hl-1">]</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">grant</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">auth</span><span class="hl-1">.</span><span class="hl-0">getClientGrant</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Grant:&#39;</span><span class="hl-1">, </span><span class="hl-5">grant</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">example</span><span class="hl-1">()</span>
</code><button>Copy</button></pre>
<p>An instance of this class is designed to be stored as a global, long-lived
object. If you&#39;re using a serverless environment such as AWS Lambda or an
Azure Function App, you can safely instantiate this class outside of your
function handler and have it exist for as long the serverless environment
allows.</p>
</div><div class="tsd-comment tsd-typography"></div></section><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L66">src/lib/auth/CommercetoolsAuth.ts:66</a></li></ul></aside><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><details class="tsd-index-content tsd-index-accordion" open><summary class="tsd-accordion-summary tsd-index-summary"><h5 class="tsd-index-heading uppercase" role="button" aria-expanded="false" tabIndex="0"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-chevronSmall"></use></svg> Index</h5></summary><div class="tsd-accordion-details"><section class="tsd-index-section"><h3 class="tsd-index-heading">Constructors</h3><div class="tsd-index-list"><a href="CommercetoolsAuth.html#constructor" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Properties</h3><div class="tsd-index-list"><a href="CommercetoolsAuth.html#api" class="tsd-index-link tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>api</span></a>
<a href="CommercetoolsAuth.html#config" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>config</span></a>
<a href="CommercetoolsAuth.html#grant" class="tsd-index-link tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>grant?</span></a>
<a href="CommercetoolsAuth.html#grantPromise" class="tsd-index-link tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>grant<wbr/>Promise</span></a>
</div></section><section class="tsd-index-section"><h3 class="tsd-index-heading">Methods</h3><div class="tsd-index-list"><a href="CommercetoolsAuth.html#getAnonymousGrant" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>Anonymous<wbr/>Grant</span></a>
<a href="CommercetoolsAuth.html#getClientGrant" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>Client<wbr/>Grant</span></a>
<a href="CommercetoolsAuth.html#login" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>login</span></a>
<a href="CommercetoolsAuth.html#logout" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>logout</span></a>
<a href="CommercetoolsAuth.html#refreshCustomerGrant" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>refresh<wbr/>Customer<wbr/>Grant</span></a>
<a href="CommercetoolsAuth.html#revokeToken" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>revoke<wbr/>Token</span></a>
</div></section></div></details></section></section><section class="tsd-panel-group tsd-member-group"><h2>Constructors</h2><section class="tsd-panel tsd-member"><a id="constructor" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>constructor</span><a href="#constructor" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="constructor.new_CommercetoolsAuth" class="tsd-anchor"></a><span class="tsd-kind-constructor-signature">new <wbr/>Commercetools<wbr/>Auth</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">config</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><a href="CommercetoolsAuth.html" class="tsd-signature-type tsd-kind-class">CommercetoolsAuth</a><a href="#constructor.new_CommercetoolsAuth" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Store the configuration locally and do some light validation to ensure
that we have some <code>clientScopes</code> defined. We also set a <code>member</code> called
{@see api} to an instance of {@see CommercetoolsAuthApi}, which handles
the lower level commercetools request.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">config</span>: <a href="../interfaces/CommercetoolsAuthConfig.html" class="tsd-signature-type tsd-kind-interface">CommercetoolsAuthConfig</a></span></li></ul></div><h4 class="tsd-returns-title">Returns <a href="CommercetoolsAuth.html" class="tsd-signature-type tsd-kind-class">CommercetoolsAuth</a></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L100">src/lib/auth/CommercetoolsAuth.ts:100</a></li></ul></aside></li></ul></section></section><section class="tsd-panel-group tsd-member-group"><h2>Properties</h2><section class="tsd-panel tsd-member tsd-is-private"><a id="api" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag ts-flagPrivate">Private</code> <span>api</span><a href="#api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">api</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">CommercetoolsAuthApi</span></div><div class="tsd-comment tsd-typography"><p>The {@see CommercetoolsAuthApi} handles the actual sending of the request
and any lower level outgoing or incoming transformation of data.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L92">src/lib/auth/CommercetoolsAuth.ts:92</a></li></ul></aside></section><section class="tsd-panel tsd-member"><a id="config" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag ts-flagReadonly">Readonly</code> <span>config</span><a href="#config" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">config</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">Config</span></div><div class="tsd-comment tsd-typography"><p>The internal configuration. This is a combination of the <code>CommercetoolsAuthConfig</code>
type passed in to the constructor and the default values specified in the
<code>configDefaults</code> object.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L72">src/lib/auth/CommercetoolsAuth.ts:72</a></li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-private"><a id="grant" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag ts-flagPrivate">Private</code> <code class="tsd-tag ts-flagOptional">Optional</code> <span>grant</span><a href="#grant" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">grant</span><span class="tsd-signature-symbol">?:</span> <a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a></div><div class="tsd-comment tsd-typography"><p>This holds the client grant, once one has been generated.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L77">src/lib/auth/CommercetoolsAuth.ts:77</a></li></ul></aside></section><section class="tsd-panel tsd-member tsd-is-private"><a id="grantPromise" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><code class="tsd-tag ts-flagPrivate">Private</code> <span>grant<wbr/>Promise</span><a href="#grantPromise" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="tsd-signature"><span class="tsd-kind-property">grant<wbr/>Promise</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">null</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">any</span><span class="tsd-signature-symbol">&gt;</span><span class="tsd-signature-symbol"> = null</span></div><div class="tsd-comment tsd-typography"><p>Whenever we either refresh the client grant, or request a new one,
we don&#39;t want to allow any other requests to be initiated until that
request has completed. This promise is used to determine whether incoming
requests need to wait on an existing client grant request to complete
before they can start to be processed.</p>
</div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L86">src/lib/auth/CommercetoolsAuth.ts:86</a></li></ul></aside></section></section><section class="tsd-panel-group tsd-member-group"><h2>Methods</h2><section class="tsd-panel tsd-member"><a id="getAnonymousGrant" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>get<wbr/>Anonymous<wbr/>Grant</span><a href="#getAnonymousGrant" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="getAnonymousGrant.getAnonymousGrant-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">get<wbr/>Anonymous<wbr/>Grant</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">?</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span><a href="#getAnonymousGrant.getAnonymousGrant-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Get a grant for an anonymous customer.</p>
<p>If you pass a value to the <a href="../interfaces/AnonymousGrantOptions.html#anonymousId" class="tsd-kind-property">AnonymousGrantOptions.anonymousId</a>
<code>options</code> parameter property then this must not exist within the commercetools
system for your project key, otherwise an error will be thrown. Typically
this property would be left undefined and commercetools will then create
a unique id for the anonymous user automatically.</p>
<p>Example code to generate an anonymous customer grant:</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">Region</span><span class="hl-1">, </span><span class="hl-5">CommercetoolsAuth</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@gradientedge/commercetools-utils&#39;</span><br/><br/><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">example</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">auth</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CommercetoolsAuth</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">projectKey:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-project-key&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientId:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientSecret:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-secret&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">region:</span><span class="hl-1"> </span><span class="hl-5">Region</span><span class="hl-1">.</span><span class="hl-6">EUROPE_GCP</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientScopes:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;view_published_products&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;view_categories&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;manage_customers&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;create_anonymous_token&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">grant</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">auth</span><span class="hl-1">.</span><span class="hl-0">getAnonymousGrant</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Anonymous customer grant:&#39;</span><span class="hl-1">, </span><span class="hl-5">grant</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">example</span><span class="hl-1">()</span>
</code><button>Copy</button></pre>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-parameter">options</span>: <a href="../interfaces/AnonymousGrantOptions.html" class="tsd-signature-type tsd-kind-interface">AnonymousGrantOptions</a></span></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L244">src/lib/auth/CommercetoolsAuth.ts:244</a></li></ul></aside></li></ul></section><section class="tsd-panel tsd-member"><a id="getClientGrant" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>get<wbr/>Client<wbr/>Grant</span><a href="#getClientGrant" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="getClientGrant.getClientGrant-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">get<wbr/>Client<wbr/>Grant</span><span class="tsd-signature-symbol">(</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span><a href="#getClientGrant.getClientGrant-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Get a client grant</p>
<p>If we don&#39;t already have a client grant stored locally, then we make a
call to commercetools to generate one. Once we have a grant, we store it
locally and then return that cached version up until it needs to be renewed.</p>
</div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L117">src/lib/auth/CommercetoolsAuth.ts:117</a></li></ul></aside></li></ul></section><section class="tsd-panel tsd-member"><a id="login" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>login</span><a href="#login" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="login.login-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">login</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span><a href="#login.login-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Login the customer using the given options.</p>
<p>If the <a href="../interfaces/LoginOptions.html#scopes" class="tsd-kind-property">LoginOptions.scopes</a> property isn&#39;t set on the <code>options</code>
parameter then we&#39;ll use the scopes set on <a href="../interfaces/CommercetoolsAuthConfig.html#customerScopes" class="tsd-kind-property">CommercetoolsAuthConfig.customerScopes</a>.
If this doesn&#39;t contain any values either, then this method will throw
an error due to the security risk of the customer having a grant with
the same privileges as the client API key.</p>
<p>Example login code:</p>
<pre><code class="language-typescript"><span class="hl-4">import</span><span class="hl-1"> { </span><span class="hl-5">Region</span><span class="hl-1">, </span><span class="hl-5">CommercetoolsAuth</span><span class="hl-1"> } </span><span class="hl-4">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@gradientedge/commercetools-utils&#39;</span><br/><br/><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">example</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">auth</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">CommercetoolsAuth</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">projectKey:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-project-key&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientId:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-id&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientSecret:</span><span class="hl-1"> </span><span class="hl-2">&#39;your-client-secret&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">region:</span><span class="hl-1"> </span><span class="hl-5">Region</span><span class="hl-1">.</span><span class="hl-6">EUROPE_GCP</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">clientScopes:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;view_published_products&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;view_categories&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;manage_customers&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">&#39;create_anonymous_token&#39;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-6">grant</span><span class="hl-1"> = </span><span class="hl-4">await</span><span class="hl-1"> </span><span class="hl-5">auth</span><span class="hl-1">.</span><span class="hl-0">login</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-5">username:</span><span class="hl-1"> </span><span class="hl-2">&#39;test@gradientedge.com&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">password:</span><span class="hl-1"> </span><span class="hl-2">&#39;testing123&#39;</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-1">  </span><span class="hl-5">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Customer grant:&#39;</span><span class="hl-1">, </span><span class="hl-5">grant</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">example</span><span class="hl-1">()</span>
</code><button>Copy</button></pre>
<p>Note that there is no need to call <a href="CommercetoolsAuth.html#getClientGrant" class="tsd-kind-method">getClientGrant</a> in order to
generate a client grant. The class internally requests one if it
doesn&#39;t have a non-expired grant already cached locally.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">options</span>: <a href="../interfaces/LoginOptions.html" class="tsd-signature-type tsd-kind-interface">LoginOptions</a></span></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L188">src/lib/auth/CommercetoolsAuth.ts:188</a></li></ul></aside></li></ul></section><section class="tsd-panel tsd-member"><a id="logout" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>logout</span><a href="#logout" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="logout.logout-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">logout</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#logout.logout-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Logout the customer</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">options</span>: <span class="tsd-signature-type">LogoutOptions</span></span></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L269">src/lib/auth/CommercetoolsAuth.ts:269</a></li></ul></aside></li></ul></section><section class="tsd-panel tsd-member"><a id="refreshCustomerGrant" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>refresh<wbr/>Customer<wbr/>Grant</span><a href="#refreshCustomerGrant" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="refreshCustomerGrant.refreshCustomerGrant-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">refresh<wbr/>Customer<wbr/>Grant</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">refreshToken</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span><a href="#refreshCustomerGrant.refreshCustomerGrant-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Refresh the customer&#39;s grant given a refresh token</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">refreshToken</span>: <span class="tsd-signature-type">string</span></span></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><a href="CommercetoolsGrant.html" class="tsd-signature-type tsd-kind-class">CommercetoolsGrant</a><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L141">src/lib/auth/CommercetoolsAuth.ts:141</a></li></ul></aside></li></ul></section><section class="tsd-panel tsd-member"><a id="revokeToken" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><span>revoke<wbr/>Token</span><a href="#revokeToken" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><ul class="tsd-signatures"><li class="tsd-signature tsd-anchor-link"><a id="revokeToken.revokeToken-1" class="tsd-anchor"></a><span class="tsd-kind-call-signature">revoke<wbr/>Token</span><span class="tsd-signature-symbol">(</span><span class="tsd-kind-parameter">options</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span><a href="#revokeToken.revokeToken-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></li><li class="tsd-description"><div class="tsd-comment tsd-typography"><p>Revoke the given access/refresh token</p>
<p>Remember that you can only revoke tokens that were generated using
this client access token.</p>
</div><div class="tsd-parameters"><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameter-list"><li><span><span class="tsd-kind-parameter">options</span>: <span class="tsd-signature-type">RevokeTokenOptions</span></span></li></ul></div><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">Promise</span><span class="tsd-signature-symbol">&lt;</span><span class="tsd-signature-type">void</span><span class="tsd-signature-symbol">&gt;</span></h4><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/gradientedge/commercetools-utils/blob/59d0ef3c9bbc4fe31af279f62cc8b763edc83123/src/lib/auth/CommercetoolsAuth.ts#L279">src/lib/auth/CommercetoolsAuth.ts:279</a></li></ul></aside></li></ul></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#constructor" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-512"></use></svg><span>constructor</span></a><a href="#api" class="tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>api</span></a><a href="#config" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>config</span></a><a href="#grant" class="tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>grant</span></a><a href="#grantPromise" class="tsd-is-private"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1024"></use></svg><span>grant<wbr/>Promise</span></a><a href="#getAnonymousGrant" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>Anonymous<wbr/>Grant</span></a><a href="#getClientGrant" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>get<wbr/>Client<wbr/>Grant</span></a><a href="#login" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>login</span></a><a href="#logout" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>logout</span></a><a href="#refreshCustomerGrant" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>refresh<wbr/>Customer<wbr/>Grant</span></a><a href="#revokeToken" class=""><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-2048"></use></svg><span>revoke<wbr/>Token</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>@gradientedge/commercetools-utils</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>